<!--
    Copyright 2014 Ed Carter

    This file is part of Deadbolt Password Generator.

    Deadbolt Password Generator is free software: you can redistribute
    it and/or modify it under the terms of the GNU General Public
    License as published by the Free Software Foundation, either
    version 3 of the License, or (at your option) any later version.

    Deadbolt Password Generator is distributed in the hope that it
    will be useful, but WITHOUT ANY WARRANTY; without even the implied
    warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Deadbolt Password Generator.  If not, see
    <http://www.gnu.org/licenses/>.
 -->

<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../pin-option/pin-option.html" />
<link rel="import" href="../password-reveal/password-reveal.html" />

<polymer-element name="deadbolt-app">
    <template>
        <link href="deadbolt-app.css" rel="stylesheet" />

        <core-drawer-panel id="drawerPanel" rightdrawer disableswipe drawerwidth="80%" forcenarrow>

            <core-header-panel drawer mode="seamed">
                <core-toolbar id="navheader'">
                    <div class="bottom fit" horizontal layout>
                        <paper-tabs selected="{{selectedProfileMode}}" flex id="profileTabs">
                            <paper-tab>
                                Custom
                            </paper-tab>
                            <paper-tab>
                                Profiles
                            </paper-tab>
                        </paper-tabs>
                    </div>
                </core-toolbar>

                <div vertical layout fit>

                    <div flex id="settings">

                        <core-animated-pages transitions="cross-fade" selected="{{selectedProfileMode}}">
                            <section>
                                <div cross-fade>
                                    <div id="customSettings">
                                        <div center horizontal layout class="option">
                                            <div flex>Include Symbols</div>
                                            <paper-checkbox checked="{{customProfile.includeSymbols}}"></paper-checkbox>
                                        </div>
                                        <div center horizontal layout class="option">
                                            <div flex>Case Sensitive</div>
                                            <paper-checkbox checked="{{customProfile.caseSensitive}}"></paper-checkbox>
                                        </div>
                                        <div center horizontal layout class="option">
                                            <div flex>Password Length: {{customProfile.passwordLength}}</div>
                                        </div>
                                        <div center horizontal layout class="option  green-slider">
                                            <paper-slider pin min="6" max="15" step="1" value="{{customProfile.passwordLength}}"></paper-slider>
                                        </div>
                                        <div center horizontal layout class="option">
                                            <div flex>Use PIN Number</div>
                                            <paper-checkbox checked="{{customProfile.usePin}}"></paper-checkbox>
                                        </div>
                                        <pin-option usepin="{{customProfile.usePin}}" pinnumber="{{customProfile.pinNumber}}"></pin-option>
                                    </div>
                                </div>
                            </section>
                            <section>
                                <div cross-fade>
                                    <core-selector selected="{{profileSelected}}" id="profileSelector">
                                        <template repeat="{{profile in profileList}}">
                                            <paper-item>{{profile.name}}</paper-item>
                                        </template>
                                    </core-selector>
                                </div>
                            </section>
                        </core-animated-pages>
                    </div>
                </div>

            </core-header-panel>

            <core-header-panel main mode="seamed">
                <core-toolbar id="mainheader">
                    <span flex>
                        <img src="deadbolt-logo.png" style="height:30px;margin-top:5px;" />
                    </span>
                    <paper-icon-button id="navicon" icon="menu"></paper-icon-button>
                </core-toolbar>
                <div class="content">
                    <div center horizontal layout id="toggleShowPhrase">
                        <div flex>Show Memorable Phrase</div>
                        <paper-toggle-button checked="{{showPhrase}}"></paper-toggle-button>
                    </div>
                    <div><h3>{{deadboltProfile.name}}</h3></div>
                    <div>
                        <paper-input-decorator floatinglabel label="Memorable Phrase">
                            <input is="core-input" type="{{showPhrase ? 'text' : 'password'}}" value="{{passPhrase}}" />
                        </paper-input-decorator>
                        <password-reveal passphrase="{{passPhrase}}" deadboltProfile="{{deadboltProfile}}"></password-reveal>
                    </div>
                </div>

            </core-header-panel>

        </core-drawer-panel>
    </template>
    <script>
        Polymer('deadbolt-app', {
            deadboltProfile: null,
            customProfile: {
                name: "Custom Profile",
                includeSymbols: true,
                caseSensitive: true,
                passwordLength: 15,
                usePin: false,
                pinNumber: '0000'
            },
            profileSelected: 0,
            profileList: null,
            showPhrase: false,
            passPhrase: '',
            getProfiles: function() {
                return new Array(
                    {
                        name: 'Standard',
                        includeSymbols: false,
                        caseSensitive: true,
                        passwordLength: 6,
                        usePin: false,
                        pinNumber: '0000'
                    },
                    {
                        name: 'High Security',
                        includeSymbols: true,
                        caseSensitive: true,
                        passwordLength: 15,
                        usePin: false,
                        pinNumber: '0000'
                    },
                    {
                        name: 'Banking',
                        includeSymbols: true,
                        caseSensitive: true,
                        passwordLength: 15,
                        usePin: false,
                        pinNumber: '0000'
                    });
            },
            ready: function () {
                this.super();
                var self = this;
                var navicon = self.$.navicon;
                var tabs = self.$.profileTabs;
                var drawerPanel = self.$.drawerPanel;
                var profileSelector = self.$.profileSelector;

                self.profileList = self.getProfiles();
                self.deadboltProfile = self.profileList.length > 0 ? self.profileList[0] : self.customProfile;
                tabs.selected = self.profileList.length > 0 ? 1 : 0;

                navicon.addEventListener('click', function () {
                    drawerPanel.togglePanel();
                });

                tabs.addEventListener('core-select', function () {
                    if (tabs.selected == 0) {
                        self.deadboltProfile = self.customProfile;
                    }
                    else {
                        console.log(self.profileList);
                        self.deadboltProfile = self.profileList[profileSelector.selected];
                    }
                });

                profileSelector.addEventListener('core-select', function() {
                    self.deadboltProfile = self.profileList[profileSelector.selected];
                });
            },

        });
    </script>
</polymer-element>
<!--
    Copyright 2014 Ed Carter

    This file is part of Deadbolt Password Generator.

    Deadbolt Password Generator is free software: you can redistribute
    it and/or modify it under the terms of the GNU General Public
    License as published by the Free Software Foundation, either
    version 3 of the License, or (at your option) any later version.

    Deadbolt Password Generator is distributed in the hope that it
    will be useful, but WITHOUT ANY WARRANTY; without even the implied
    warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
    See the GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Deadbolt Password Generator.  If not, see
    <http://www.gnu.org/licenses/>.
 -->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/core-item/core-item.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-slider/paper-slider.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../pin-option/pin-option.html" />
<link rel="import" href="../password-reveal/password-reveal.html" />
<link rel="import" href="../profile-options/profile-options.html" />

<polymer-element name="deadbolt-app">
    <template>
        <link href="deadbolt-app.css" rel="stylesheet" />

        <core-drawer-panel id="drawerPanel" class="right-drawer">

            <core-header-panel drawer mode="seamed">
                <core-toolbar id="navheader'">
                    <span>Settings</span>
                </core-toolbar>
                <profile-options selectedprofile="{{selectedProfile}}"></profile-options>
            </core-header-panel>

            <core-header-panel main mode="seamed">
                <core-toolbar id="mainheader">
                    <span flex>
                        <img src="deadbolt-logo.png" style="height:30px;margin-top:5px;" />
                    </span>
                    <paper-icon-button id="navicon" icon="menu"></paper-icon-button>
                </core-toolbar>
                <div class="content">
                    <div center horizontal layout id="toggleShowPhrase">
                        <div flex>Show Memorable Phrase</div>
                        <paper-toggle-button checked="{{showPhrase}}"></paper-toggle-button>
                    </div>
                    <div>
                        <paper-input floatinglabel label="Memorable Phrase" type="{{showPhrase ? 'text' : 'password'}}" inputvalue="{{passPhrase}}"></paper-input>
                        <password-reveal passphrase="{{passPhrase}}" selectedProfile="{{selectedProfile}}"></password-reveal>
                    </div>
                </div>

                <input type="button" on-click="{{scanBarcode}}" value="Scan" />

            </core-header-panel>

        </core-drawer-panel>
    </template>
    <script>
        Polymer('deadbolt-app', {
            showPhrase: false,
            selectedProfile: {},
            passPhrase: '',
            ready: function () {
                this.super();
                var navicon = this.$.navicon;
                var drawerPanel = this.$.drawerPanel;
                navicon.addEventListener('click', function () {
                    drawerPanel.togglePanel();
                });
            },
            scanBarcode: function () {
                console.log('scanning');
                cordova.plugins.barcodeScanner.scan(
                  function (result) {
                      alert("We got a barcode\n" +
                            "Result: " + result.text + "\n" +
                            "Format: " + result.format + "\n" +
                            "Cancelled: " + result.cancelled);
                  },
                  function (error) {
                      alert("Scanning failed: " + error);
                  }
               );
            }
        });
    </script>
</polymer-element>